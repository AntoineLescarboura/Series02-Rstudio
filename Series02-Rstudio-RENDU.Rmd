---
title: "Series02-Rstudio-RENDU"
output: html_document
date: "2025-10-01"
---

<br>
<br>
<br>
<br>

## 2.1 Make clear what is a statistical test, and when to use it.
Below are some questions to guide your analysis. You can answer them in your notebook, with a short sentence for each question.

- What is a median? A mean?

A median is the value right in the middle between the maximum and the minimum of the dataset.
A mean is the average of all the values of the dataset.  


- What is a variance? A standard deviation?

The variance is the measure of data spread, the average squared deviation from the mean.
The standard deviation is the square root of the variance.


- What is a normal distribution?

A normal distribution is when the values are symetrical around the mean value. Graphicly, it has the shape of a bell.


- What is a statistical test?

A statistical test is a test that allows to decide of data support or reject the hypothesis H0 that was chosen before the test.


- When to use a statistical test?

When we need to determine of a result is statistically significant or if it's due to chance or hazard.


- What is a parametric test? A non-parametric test?

A parametric test is a test where we assume a specific distribution. On the other end, a non-parametric test is where there are no distribution assumptions.


- What are the assumptions of parametric tests?

Normality, homogeneity of variances, independence of observations.


- What are the assumptions of non-parametric tests?

Often require independent samples and ordinal/continuous data.


- What is a p-value?

The p-value is the probability of obtaining data as extreme as observed, under the null hypothesis.
It allows to know if there's a correlation between two datasets.


- What is the risk of error when using a statistical test?

The risk of error in a statistical test means either rejecting a true null hypothesis (Type I error) or failing to reject a 
Reference: *Statistical Methods* (Snedecor & Cochran, 1989)


- What is the difference between a paired and an unpaired test?

A paired test compare measurements on the the same subjects before and after treatments while an unpaired test compare measurements between different groups.


---


<br>
<br>
<br>
<br>
<br>
<br>

# 2.2 Effect of Treatment Over Time

<br>
<br>

```{r setup, include=FALSE}
# Import of all the libraries I'll need in this homework
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(here)
library(tidyr)
library(corrplot)

```



## 2.2.1 The Data
```{r}
# Load data
data_prepost <- read.csv("Datas/PrePost.csv")
print(data_prepost)
```

<table style="border-collapse:collapse; width:100%; max-width:700px; font-family:Arial, sans-serif;">
  <caption style="caption-side:top; text-align:left; font-weight:600; padding:6px 0;">Tableau des variables mesurées</caption>
  <thead>
    <tr>
      <th style="border:1px solid #ccc; padding:8px; text-align:left; background:#f2f2f2;">Variable</th>
      <th style="border:1px solid #ccc; padding:8px; text-align:left; background:#f2f2f2;">Description</th>
      <th style="border:1px solid #ccc; padding:8px; text-align:left; background:#f2f2f2;">Unit</th>
      <th style="border:1px solid #ccc; padding:8px; text-align:left; background:#f2f2f2;">Possible values</th>
      <th style="border:1px solid #ccc; padding:8px; text-align:left; background:#f2f2f2;">Expected change</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="border:1px solid #ccc; padding:8px;">perf</td>
      <td style="border:1px solid #ccc; padding:8px;">Performance index</td>
      <td style="border:1px solid #ccc; padding:8px;">N/A</td>
      <td style="border:1px solid #ccc; padding:8px;">125–148</td>
      <td style="border:1px solid #ccc; padding:8px;">Increase</td>
    </tr>
    <tr>
      <td style="border:1px solid #ccc; padding:8px;">time</td>
      <td style="border:1px solid #ccc; padding:8px;">Measurement time</td>
      <td style="border:1px solid #ccc; padding:8px;">categorical</td>
      <td style="border:1px solid #ccc; padding:8px;">Before, After</td>
      <td style="border:1px solid #ccc; padding:8px;">N/A</td>
    </tr>
  </tbody>
</table>


<br>
<br>



## 2.2.2 The analysis


- Does the treatment have an effect?

Yes, the treatment appears to have an effect: performance after rehabilitation is higher compared to before.


- What comparison are you going to make?

We compare the same individuals’ performance before vs. after rehabilitation (paired data).


- Which test will you use? Parametric or non-parametric?

The sataset is normally distributed so I will use a paired t-test (parametric).


- Which graph illustrates the effect of the treatment?

A boxplot (Before vs. After) or a line plot connecting paired observations best illustrates the effect.



```{r}
# Load PrePost data
data_prepost <- read.csv("Datas/PrePost.csv")


# Create ID variable for pairing
data_prepost$ID <- rep(1:(nrow(data_prepost)/2), times = 2)


# Ensure Before → After order
data_prepost$time <- factor(data_prepost$time, levels = c("Before", "After"), ordered = TRUE)


# Separate vectors for paired test
before <- data_prepost$perf[data_prepost$time == "Before"]
after <- data_prepost$perf[data_prepost$time == "After"]


# Paired t-test
paired_test <- t.test(before, after, paired = TRUE)
paired_test
```


```{r}
# Boxplot with forced order

ggplot(data_prepost, aes(x = time, y = perf, fill = time)) +
geom_boxplot() +
scale_fill_manual(values = c("Before" = "steelblue", "After" = "seagreen")) +
labs(title = "Performance Before and After Rehabilitation",
x = "Time",
y = "Performance") +
scale_x_discrete(limits = c("Before", "After")) +
theme_minimal()
```


- What sentence will you write in your thesis to explain your result?

The rehabilitation training significantly improved participants’ performance, as shown by a paired t-test (p < 0.05).


---

<br>
<br>
<br>
<br>
<br>
<br>


# 2.3 Testing Some Stereotypes

<br>
<br>

## 2.3.1 The Data
```{r}
data_snore <- read.table("Datas/snore.txt", header = TRUE)
head(data_snore)
```

<br>
<br>
<br>
<br>


## 2.3.2 The Analysis

<br>
<br>

### Are snorers fatter?
```{r message=FALSE, warning=FALSE}
# Box plot of weight by snoring status
ggplot(data_snore, aes(x = snore, y = weight, fill = snore)) +
  geom_boxplot() +
  labs(title = "Weight Distribution by Snoring Status",
       x = "Snoring Status",
       y = "Weight (kg)") +
  theme_minimal()

# Summary statistics
data_snore %>%
  group_by(snore) %>%
  summarise(mean_weight = mean(weight, na.rm = TRUE),
            median_weight = median(weight, na.rm = TRUE),
            sd_weight = sd(weight, na.rm = TRUE))
```

<br>

The boxplots and the summary statistics are showing us that the weight distribution by the snoring status seems relatively equivalent so we could conclude that no, snorers aren't fatter.

<br>
<br>

### Do snorers drink or smoke more?
```{r}
# Bar plot of drinking status by snoring status
ggplot(data_snore, aes(x = factor(alcool), fill = factor(snore))) +
  geom_bar(position = "dodge") +
  labs(title = "Number of People per Alcohol Consumption and Snoring Status",
       x = "Amount of Alcohol Consumed",
       y = "Number of People",
       fill = "Snorers") +
  theme_minimal()

# Bar plot of smoking status by snoring status
ggplot(data_snore, aes(x = snore, fill = tabac)) +
  geom_bar(position = "dodge") +
  labs(title = "Smoking Status by Snoring Status",
       x = "Snoring Status",
       y = "Proportion") +
  theme_minimal()
```

<br>

The first barplot can indicate that someone who doesn't drink at all has a bigger chance to not snore but exept that, it seems that the snoring isn't really related to the alcohol consumption.

<br>

In the second barplot, we could maybe conclude that smoking helps snore less but that the reciprocate is not true (not smoking doesn't increase the snoring).

<br>
<br>

### Are men fatter?
```{r message=FALSE, warning=FALSE}
data_snore$sex <- ifelse(data_snore$sex == "H", "Male", "Female")

ggplot(data_snore, aes(x = sex, y = weight, fill = sex)) +
  geom_boxplot(alpha = 0.7) +
  labs(title = "Weight Distribution by Sex",
       x = "Sex",
       y = "Weight (kg)") +
  theme_minimal()

# Summary statistics
data_snore %>%
  group_by(sex) %>%
  summarise(
    count = n(),
    mean = mean(weight, na.rm = TRUE),
    sd = sd(weight, na.rm = TRUE),
    min = min(weight, na.rm = TRUE),
    Q1 = quantile(weight, 0.25, na.rm = TRUE),
    median = median(weight, na.rm = TRUE),
    Q3 = quantile(weight, 0.75, na.rm = TRUE),
    max = max(weight, na.rm = TRUE)
  )
```

<br>

These boxplots reveals that males of this dataset can be heavier but the mean weight of women is superior to the mean weight of men. We can conclude that men aren't fatter (but women aren't either).

<br>
<br>

### Do women smoke less?
```{r}
# Calculate percentage of smokers by sex
smoking_percent <- data_snore %>%
  group_by(sex) %>%
  summarise(percent_smoker = mean(tabac == "O") * 100, .groups = "drop") %>%
  complete(sex, fill = list(percent_smoker = 0))

# Side-by-side bar plot
ggplot(smoking_percent, aes(x = sex, y = percent_smoker, fill = sex)) +
  geom_col(width = 0.5) +
  geom_text(aes(label = paste0(round(percent_smoker, 1), "%")),
            vjust = -0.5, size = 5) +
  coord_cartesian(ylim = c(0, 100)) +
  labs(title = "Percentage of Smokers by Sex",
       x = "Sex",
       y = "Percentage") +
  theme_minimal() +
  theme(legend.position = "none")
```

<br>

In this dataset, we have 40% of women smoking while 72% of men are smoking. So, following this dataset, we could say that yes, women smoke less than men.

<br>
<br>

### Correlations between variables
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
numeric_vars <- data_snore %>% select(where(is.numeric))

cor_matrix <- cor(numeric_vars, use = "complete.obs")

corrplot(
  cor_matrix,
  method = "circle",      
  type = "upper",        
  diag = FALSE,          
  tl.col = "black",      
  tl.srt = 45,        
  title = "Correlation Matrix of Numeric Variables",
  mar = c(0,0,2,0)    
)
```

There is a big positive correlation (nearly =  1) between height and weight so we can easily affirm that a heavier person is taller and a taller person is heavier, which seems pretty logical.
We can also see on this correlation matrix that there is a small negative correlation (close to -1) between age and alcohol which means that people have a tendancy to consume less alcohol while aging.

---
